<!-- Filtros de Vagas -->
<div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8">
    <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
            <span>💼</span>
            Suas Vagas
        </h3>
        <div class="flex gap-2">
            <button onclick="filtrarVagas('todas')"
                    class="filter-btn active bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300">
                Todas
            </button>
            <button onclick="filtrarVagas('Ativa')"
                    class="filter-btn bg-gray-100 text-gray-700 px-4 py-2 rounded-xl font-medium transition-all duration-300">
                Ativas
            </button>
            <button onclick="filtrarVagas('Congelada')"
                    class="filter-btn bg-gray-100 text-gray-700 px-4 py-2 rounded-xl font-medium transition-all duration-300">
                Congeladas
            </button>
            <button onclick="filtrarVagas('Concluída')"
                    class="filter-btn bg-gray-100 text-gray-700 px-4 py-2 rounded-xl font-medium transition-all duration-300">
                Concluídas
            </button>
        </div>
    </div>

    <div class="grid gap-6">
        {% for vaga in vagas %}
        <div class="vaga-card group bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-xl hover:border-purple-200 transition-all duration-300 transform hover:-translate-y-1"
             data-status="{{ vaga.status }}">

            <!-- Header do card -->
            <div class="flex flex-col lg:flex-row lg:items-start justify-between gap-4 mb-6">
                <div class="flex-1">
                    <div class="flex items-center gap-3 mb-3">
                        <h3 class="text-xl font-bold text-gray-800 group-hover:text-purple-600 transition-colors">
                            {{ vaga.titulo }}
                        </h3>

                        <!-- Status badges -->
                        {% if vaga.status == 'Ativa' %}
                        <span class="bg-green-100 text-green-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">
                            ✅ Ativa
                        </span>
                        {% elif vaga.status == 'Congelada' %}
                        <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">
                            ❄️ Congelada
                        </span>
                        {% elif vaga.status == 'Concluída' %}
                        <span class="bg-purple-100 text-purple-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">
                            🎉 Concluída
                        </span>
                        {% endif %}

                        <!-- Urgência -->
                        {% if vaga.urgencia_contratacao == 'Imediata' %}
                        <span class="bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full animate-pulse">
                            🔥 URGENTE
                        </span>
                        {% endif %}
                    </div>

                    <!-- Info básica -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-600 mb-4">
                        <div class="flex items-center gap-2">
                            <span>💰</span>
                            <span class="font-semibold text-green-600">R$ {{ "%.2f"|format(vaga.salario_oferecido) }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span>📅</span>
                            <span>{{ vaga.data_criacao }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span>🏢</span>
                            <span>{{ vaga.tipo_vaga or 'Presencial' }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span>👥</span>
                            <span class="font-semibold">{{ vaga.total_candidatos }} candidato{{ 's' if vaga.total_candidatos != 1 else '' }}</span>
                        </div>
                    </div>

                    <!-- Congelamento programado -->
                    {% if vaga.data_congelamento_agendado and vaga.status == 'Ativa' %}
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
                        <div class="flex items-center gap-2">
                            <span class="text-blue-600">⏰</span>
                            <span class="text-sm font-medium text-blue-800">
                                Congelamento programado para: {{ vaga.data_congelamento_agendado }}
                            </span>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Candidato contratado -->
                    {% if vaga.status == 'Concluída' and vaga.candidato_contratado %}
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
                        <div class="flex items-center gap-2">
                            <span class="text-green-600">🎉</span>
                            <span class="text-sm font-medium text-green-800">
                                Candidato contratado: {{ vaga.candidato_contratado.nome }}
                                {% if vaga.candidato_contratado.posicao %}
                                ({{ vaga.candidato_contratado.posicao }}º posição)
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- Stats do lado direito -->
                <div class="flex flex-col items-center gap-4 lg:w-48">
                    <div class="text-center bg-gradient-to-br {{ vaga.feedback_ia.cor }} p-4 rounded-xl shadow-md min-w-[120px]">
                        <div class="text-2xl mb-2">{{ vaga.feedback_ia.icone }}</div>
                        <div class="text-xs font-semibold text-white">{{ vaga.feedback_ia.texto }}</div>
                    </div>

                    <!-- Candidatos por score -->
                    {% if vaga.total_candidatos > 0 %}
                    <div class="flex gap-2 text-xs">
                        {% if vaga.candidatos_80_plus > 0 %}
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium">
                            ⭐ {{ vaga.candidatos_80_plus }}
                        </span>
                        {% endif %}
                        {% if vaga.candidatos_60_79 > 0 %}
                        <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium">
                            ⚡ {{ vaga.candidatos_60_79 }}
                        </span>
                        {% endif %}
                        {% if vaga.candidatos_abaixo_60 > 0 %}
                        <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded-full font-medium">
                            📋 {{ vaga.candidatos_abaixo_60 }}
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Ações -->
            <div class="flex flex-wrap gap-3 pt-4 border-t border-gray-100">
                {% if vaga.status == 'Ativa' %}
                {% if vaga.total_candidatos > 0 %}
                <a href="{{ url_for('candidatos_vaga', vaga_id=vaga.id) }}"
                   class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>👥</span>
                    Ver Candidatos ({{ vaga.total_candidatos }})
                </a>
                {% endif %}
                <a href="{{ url_for('editar_vaga', vaga_id=vaga.id) }}"
                   class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>✏️</span>
                    Editar
                </a>
                {% elif vaga.status == 'Congelada' %}
                {% if vaga.total_candidatos > 0 %}
                <a href="{{ url_for('candidatos_vaga', vaga_id=vaga.id) }}"
                   class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>👥</span>
                    Ver Candidatos ({{ vaga.total_candidatos }})
                </a>
                {% endif %}
                <button onclick="reativarVaga({{ vaga.id }})"
                        class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>🔄</span>
                    Reativar
                </button>
                {% elif vaga.status == 'Concluída' %}
                {% if vaga.total_candidatos > 0 %}
                <a href="{{ url_for('candidatos_vaga', vaga_id=vaga.id) }}"
                   class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>👥</span>
                    Ver Candidatos ({{ vaga.total_candidatos }})
                </a>
                {% endif %}
                <a href="{{ url_for('excluir_vaga', vaga_id=vaga.id) }}"
                   class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                    <span>🗑️</span>
                    Excluir
                </a>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>